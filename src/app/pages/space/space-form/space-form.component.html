<div class="relative h-full">
    <app-form-builder
        [spaceId]="spaceId"
        [createMode]="false"
        [versionId]="versionId"
        (onFormUpdated)="onFormUpdated($event)"
        #formBuilder
    ></app-form-builder>
    <div class="absolute top-0 right-0 flex items-center" style="transform: translate(-5%, 25%);">
        
        <p-dropdown 
            [options]="formVersions"
            [(ngModel)]="versionId"
            appendTo="body"
            styleClass="bg-gray-50 border border-gray-300 w-full"
            optionLabel="createdAt"
            optionValue="id"
            placeholder="Chọn phiên bản biểu mẫu" 
        />

        <app-button
            text="Lưu"
            styleClass="ml-2"
            (onClick)="formBuilder.save()"
            [disabled]="formVersions.length == 0 || versionId != formVersions[0].id"
        >
        </app-button>

        <app-button
            text="Chia sẻ"
            styleClass="mx-2"
            (onClick)="shareForm()"
            style="margin-right: 12px;"
        >
        </app-button>


    </div>
</div>

<p-dialog 
    header="Chia sẻ biểu mẫu" 
    [(visible)]="shareDialogVisible" 
    [modal]="true" 
    [style]="{ width: '30vw' }"
    [resizable]="false" 
    [draggable]="false">
    <div *ngIf="shareLink">
        <input 
            type="text" 
            [value]="shareLink" 
            readonly 
            class="w-full p-inputtext p-component p-filled"
            style="margin-bottom: 1rem; border: 2px solid #ccc; padding: 0.5rem;" />
        <div style="text-align: right;">
            <app-button 
                text="Sao chép"
                [icon]="'pi pi-copy'" 
                (onClick)="onCopySuccess()"
                style="margin-top: 1rem;">
            </app-button>
        </div>
    </div>
</p-dialog>
